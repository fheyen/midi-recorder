(this["webpackJsonpmidi-recorder"]=this["webpackJsonpmidi-recorder"]||[]).push([[0],{25:function(e,t,r){},32:function(e,t,r){},34:function(e,t,r){},35:function(e,t,r){"use strict";r.r(t);var n=r(3),a=r.n(n),c=r(17),o=r.n(c),i=(r(25),r(6)),s=r.n(i),d=r(14),l=r(9),u=r(10),h=r(11),j=r(13),b=r(12),m=r(5),p=r(2),v=r(15),f=r(18),g=r(4),O=(r(32),r(0)),x=function(e){Object(j.a)(r,e);var t=Object(b.a)(r);function r(e){var n;Object(l.a)(this,r),(n=t.call(this,e)).prepareDownload=function(){var e=n.state,t=e.date,r=e.name,a=e.prevNames,c=n.props,o=c.saveData,i=c.audioBlob,s=c.hideFileNamePrompt;a.includes(r)||""===r||(a.push(r),a.sort(),g.Utils.storeObjectInLocalStorage("previousNames",a));var d=g.Utils.formatDate(t),l="".concat(r,"_").concat(d,".json"),u=Object(v.a)(Object(v.a)({},o),{},{fileName:l,name:r,date:t});if(n.download(JSON.stringify(u),l),i){var h=i.type.split("/")[1].split(";")[0],j="".concat(r,"_").concat(d,".").concat(h);Object(f.saveAs)(i,j)}s()},n.download=function(e,t){var r=document.createElement("a");r.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),r.setAttribute("download",t),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r)},n.handleSearchEntry=function(e){var t=e.target.value.toLowerCase(),r=n.state.prevNames.filter((function(e){return e.toLowerCase().includes(t)}));n.setState({prevNamesFiltered:r,name:t})};var a=g.Utils.getObjectFromLocalStorage("previousNames")||[],c=new Date;return n.state={isRecording:!1,recordAudio:!0,date:c,name:"Unnamed",prevNames:a,prevNamesFiltered:a},n}return Object(u.a)(r,[{key:"render",value:function(){var e=this,t=this.state,r=t.name,n=t.prevNamesFiltered;return Object(O.jsx)("div",{className:"FileNamePrompt",children:Object(O.jsxs)("div",{children:[Object(O.jsx)("div",{className:"nameInputDiv",children:Object(O.jsxs)("label",{children:["Name:\xa0",Object(O.jsx)("input",{className:"nameInput",type:"text",onChange:this.handleSearchEntry,value:r})]})}),Object(O.jsx)("div",{children:Object(O.jsxs)("button",{className:"downloadBtn",onClick:this.prepareDownload,children:[Object(O.jsx)(p.a,{icon:m.b,fixedWidth:!0}),"\xa0 Download"]})}),"Previous names:",Object(O.jsx)("div",{className:"prevNamesList",children:n.map((function(t){return Object(O.jsx)("span",{className:"prevName",onClick:function(){return e.setState({name:t})},children:t},t)}))})]})})}}]),r}(n.PureComponent),N=(r(34),function(e){Object(j.a)(r,e);var t=Object(b.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e)).startRecording=function(){console.log("Starting recording");var e=n.state,t=e.midiRecorder,r=e.audioRecorder,a=e.recordAudio;t?(n.setState({isRecording:!0,showFileNamePrompt:!1}),n.recordingStart=new Date,t.start(),a&&r&&r.start()):alert("Cannot record MIDI, no access to device!")},n.stopRecording=function(){return n.setState({isRecording:!1},(function(){return n.finishRecording(Object(h.a)(n))}))},n.hideFileNamePrompt=function(){return n.setState({showFileNamePrompt:!1})},n.toggleAudioRecording=function(){var e=!n.state.recordAudio;g.Utils.storeObjectInLocalStorage("recordAudio",e),n.setState({recordAudio:e})},n.state={isRecording:!1,recordAudio:g.Utils.getObjectFromLocalStorage("recordAudio")||!1,showFileNamePrompt:!1,midiRecorder:null,audioRecorder:null},n.pageLoad=new Date,n.recordingStart=new Date,n}return Object(u.a)(r,[{key:"componentDidMount",value:function(){var e=Object(d.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=this,e.next=4,Object(g.recordMidi)();case 4:e.t1=e.sent,e.t2={midiRecorder:e.t1},e.t0.setState.call(e.t0,e.t2),this.pageLoad=new Date,console.log("MIDI access sucessful at ".concat(this.pageLoad)),e.next=14;break;case 11:e.prev=11,e.t3=e.catch(0),console.log(e.t3);case 14:return e.prev=14,e.t4=this,e.next=18,Object(g.recordAudio)();case 18:e.t5=e.sent,e.t6={audioRecorder:e.t5},e.t4.setState.call(e.t4,e.t6),console.log("Audio access sucessful"),e.next=27;break;case 24:e.prev=24,e.t7=e.catch(14),console.log(e.t7);case 27:case"end":return e.stop()}}),e,this,[[0,11],[14,24]])})));return function(){return e.apply(this,arguments)}}()},{key:"finishRecording",value:function(){var e=Object(d.a)(s.a.mark((function e(t){var r,n,a,c,o,i,d,l,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.state,n=r.midiRecorder,a=r.audioRecorder,c=r.recordAudio,console.log("Stopping recording"),o=null,!c||!a){e.next=7;break}return e.next=6,a.stop();case 6:o=e.sent;case 7:if((i=n.stop())&&0!==i.length){e.next=11;break}if(window.confirm("No MIDI notes where recorded, save anyways?")){e.next=11;break}return e.abrupt("return");case 11:d=(t.pageLoad-t.recordingStart)/1e3,l=new g.NoteArray(i).shiftTime(d).getNotes(),console.log("Offsetting notes by ".concat(d," seconds, first will start at ").concat(l[0].start,"}")),console.log(l),u={notes:l,speed:1,selectedTrack:0,timeSelection:null},this.setState({showFileNamePrompt:!0,saveData:u,audioBlob:o});case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.isRecording,r=e.recordAudio,n=e.midiRecorder,a=e.audioRecorder,c=e.showFileNamePrompt,o=e.saveData,i=e.audioBlob;return Object(O.jsxs)("div",{className:"Toolbar",children:[Object(O.jsxs)("div",{children:[Object(O.jsxs)("button",{title:"Start recording",onClick:this.startRecording,disabled:t,children:[Object(O.jsx)("span",{style:{color:"rgb(175, 0, 0)"},children:Object(O.jsx)(p.a,{icon:m.a,fixedWidth:!0})}),"Start recording"]}),Object(O.jsxs)("button",{title:"Finish recording",onClick:this.stopRecording,disabled:!t,children:[Object(O.jsx)(p.a,{icon:m.e,fixedWidth:!0}),"Finish recording"]})]}),Object(O.jsx)("div",{children:Object(O.jsxs)("button",{onClick:this.toggleAudioRecording,disabled:t,children:[Object(O.jsx)(p.a,{icon:r?m.h:m.g,fixedWidth:!0}),"\xa0 Record audio"]})}),Object(O.jsxs)("div",{children:[!n&&Object(O.jsxs)("div",{title:"No MIDI access, cannot record anything! Connect device and reload page",children:[Object(O.jsxs)("span",{className:"fa-layers fa-fw",style:{verticalAlign:"middle"},children:[Object(O.jsx)(p.a,{icon:m.d,fixedWidth:!0}),Object(O.jsx)(p.a,{icon:m.f,fixedWidth:!0})]}),"\xa0 No MIDI"]}),!a&&Object(O.jsxs)("div",{title:"No microphone access, cannot record audio! Connect device and reload page",children:[Object(O.jsx)(p.a,{icon:m.c,fixedWidth:!0}),"\xa0 No microphone"]})]}),c&&Object(O.jsx)(x,{saveData:o,audioBlob:i,hideFileNamePrompt:this.hideFileNamePrompt})]})}}]),r}(n.PureComponent)),w=r(19);var y=function(){return Object(O.jsxs)("div",{className:"App bright",children:[Object(O.jsx)(N,{}),Object(O.jsx)("div",{className:"githubLink",children:Object(O.jsxs)("a",{href:"https://github.com/fheyen/midi-recorder",children:[Object(O.jsx)(p.a,{icon:w.a}),"\xa0 https://github.com/fheyen/midi-recorder"]})})]})};o.a.render(Object(O.jsx)(a.a.StrictMode,{children:Object(O.jsx)(y,{})}),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.ec2a4be7.chunk.js.map